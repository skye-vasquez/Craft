"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/store-login/route";
exports.ids = ["app/api/auth/store-login/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:buffer":
/*!******************************!*\
  !*** external "node:buffer" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:buffer");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:util":
/*!****************************!*\
  !*** external "node:util" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("node:util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstore-login%2Froute&page=%2Fapi%2Fauth%2Fstore-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstore-login%2Froute.ts&appDir=%2Fhome%2Fproject%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstore-login%2Froute&page=%2Fapi%2Fauth%2Fstore-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstore-login%2Froute.ts&appDir=%2Fhome%2Fproject%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_project_app_api_auth_store_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/store-login/route.ts */ \"(rsc)/./app/api/auth/store-login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/store-login/route\",\n        pathname: \"/api/auth/store-login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/store-login/route\"\n    },\n    resolvedPagePath: \"/home/project/app/api/auth/store-login/route.ts\",\n    nextConfigOutput,\n    userland: _home_project_app_api_auth_store_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/store-login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGc3RvcmUtbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZzdG9yZS1sb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZzdG9yZS1sb2dpbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGcHJvamVjdCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGaG9tZSUyRnByb2plY3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ0Q7QUFDNUU7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb21wbGlhbmNlLWV2aWRlbmNlLXBvcnRhbC8/MWQ5YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvaG9tZS9wcm9qZWN0L2FwcC9hcGkvYXV0aC9zdG9yZS1sb2dpbi9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9zdG9yZS1sb2dpbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvc3RvcmUtbG9naW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvc3RvcmUtbG9naW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvaG9tZS9wcm9qZWN0L2FwcC9hcGkvYXV0aC9zdG9yZS1sb2dpbi9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXV0aC9zdG9yZS1sb2dpbi9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstore-login%2Froute&page=%2Fapi%2Fauth%2Fstore-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstore-login%2Froute.ts&appDir=%2Fhome%2Fproject%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/store-login/route.ts":
/*!*******************************************!*\
  !*** ./app/api/auth/store-login/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   dynamic: () => (/* binding */ dynamic)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n/* harmony import */ var _lib_auth_session__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth/session */ \"(rsc)/./lib/auth/session.ts\");\n/* harmony import */ var _lib_auth_rate_limit__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/auth/rate-limit */ \"(rsc)/./lib/auth/rate-limit.ts\");\n/* harmony import */ var _lib_validations__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/validations */ \"(rsc)/./lib/validations.ts\");\n/* harmony import */ var _lib_audit__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/audit */ \"(rsc)/./lib/audit.ts\");\n\n\n\n\n\n\n\nconst dynamic = \"force-dynamic\";\nconst COOKIE_NAME = \"compliance-session\";\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const validation = _lib_validations__WEBPACK_IMPORTED_MODULE_5__.storeLoginSchema.safeParse(body);\n        if (!validation.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: validation.error.errors[0].message\n            }, {\n                status: 400\n            });\n        }\n        const { storeName, pin } = validation.data;\n        const rateLimitKey = `store-login:${storeName}`;\n        const rateLimit = (0,_lib_auth_rate_limit__WEBPACK_IMPORTED_MODULE_4__.checkRateLimit)(rateLimitKey, _lib_auth_rate_limit__WEBPACK_IMPORTED_MODULE_4__.RATE_LIMITS.storeLogin);\n        if (!rateLimit.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Too many login attempts. Please try again later.\"\n            }, {\n                status: 429\n            });\n        }\n        const { data: store, error: storeError } = await _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.supabaseAdmin.from(\"stores\").select(\"id, name\").eq(\"name\", storeName).maybeSingle();\n        if (storeError || !store) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid store or PIN\"\n            }, {\n                status: 401\n            });\n        }\n        const { data: auth, error: authError } = await _lib_supabase_server__WEBPACK_IMPORTED_MODULE_2__.supabaseAdmin.from(\"store_auth\").select(\"pin_hash\").eq(\"store_id\", store.id).maybeSingle();\n        if (authError || !auth) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Store authentication not configured\"\n            }, {\n                status: 401\n            });\n        }\n        const isValidPin = await bcryptjs__WEBPACK_IMPORTED_MODULE_1___default().compare(pin, auth.pin_hash);\n        if (!isValidPin) {\n            (0,_lib_audit__WEBPACK_IMPORTED_MODULE_6__.logAudit)({\n                actor_type: \"store_user\",\n                actor_label: storeName,\n                action: \"store_login_failed\",\n                metadata: {\n                    store_id: store.id,\n                    reason: \"invalid_pin\"\n                }\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid store or PIN\"\n            }, {\n                status: 401\n            });\n        }\n        const token = await (0,_lib_auth_session__WEBPACK_IMPORTED_MODULE_3__.createSession)({\n            type: \"store\",\n            storeId: store.id,\n            storeName: store.name\n        });\n        (0,_lib_audit__WEBPACK_IMPORTED_MODULE_6__.logAudit)({\n            actor_type: \"store_user\",\n            actor_label: storeName,\n            action: \"store_login_success\",\n            metadata: {\n                store_id: store.id\n            }\n        });\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            store: {\n                id: store.id,\n                name: store.name\n            }\n        });\n        response.cookies.set(COOKIE_NAME, token, {\n            httpOnly: true,\n            secure: \"development\" === \"production\",\n            sameSite: \"lax\",\n            path: \"/\",\n            maxAge: 60 * 60 * 24 * 7\n        });\n        return response;\n    } catch (error) {\n        console.error(\"Store login error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"An unexpected error occurred\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNckIsTUFBTXFCLElBQUk7WUFBQztRQUMxQztRQUVBQyxTQUFTQyxPQUFPLENBQUNDLEdBQUcsQ0FBQzFDLGFBQWFvQyxPQUFPO1lBQ3ZDTyxVQUFVO1lBQ1ZDLFFBQVFDLGFBQW9CLEtBQUs7WUFDakNHLFVBQVU7WUFDVkMsTUFBTTtZQUNOQyxRQUFRLEtBQUssS0FBSyxLQUFLO1FBQ3pCO1FBRUEsT0FBT1Y7SUFDVCxFQUFFLE9BQU9oQyxPQUFPO1FBQ2QyQyxRQUFRM0MsS0FBSyxDQUFDLHNCQUFzQkE7UUFDcEMsT0FBT2pCLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO1lBQUVJLE9BQU87UUFBK0IsR0FDeEM7WUFBRUcsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb21wbGlhbmNlLWV2aWRlbmNlLXBvcnRhbC8uL2FwcC9hcGkvYXV0aC9zdG9yZS1sb2dpbi9yb3V0ZS50cz81MDY1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgYmNyeXB0IGZyb20gJ2JjcnlwdGpzJztcbmltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xuaW1wb3J0IHsgY3JlYXRlU2Vzc2lvbiB9IGZyb20gJ0AvbGliL2F1dGgvc2Vzc2lvbic7XG5pbXBvcnQgeyBjaGVja1JhdGVMaW1pdCwgUkFURV9MSU1JVFMgfSBmcm9tICdAL2xpYi9hdXRoL3JhdGUtbGltaXQnO1xuaW1wb3J0IHsgc3RvcmVMb2dpblNjaGVtYSB9IGZyb20gJ0AvbGliL3ZhbGlkYXRpb25zJztcbmltcG9ydCB7IGxvZ0F1ZGl0IH0gZnJvbSAnQC9saWIvYXVkaXQnO1xuXG5leHBvcnQgY29uc3QgZHluYW1pYyA9ICdmb3JjZS1keW5hbWljJztcblxuY29uc3QgQ09PS0lFX05BTUUgPSAnY29tcGxpYW5jZS1zZXNzaW9uJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgdmFsaWRhdGlvbiA9IHN0b3JlTG9naW5TY2hlbWEuc2FmZVBhcnNlKGJvZHkpO1xuXG4gICAgaWYgKCF2YWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogdmFsaWRhdGlvbi5lcnJvci5lcnJvcnNbMF0ubWVzc2FnZSB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBzdG9yZU5hbWUsIHBpbiB9ID0gdmFsaWRhdGlvbi5kYXRhO1xuXG4gICAgY29uc3QgcmF0ZUxpbWl0S2V5ID0gYHN0b3JlLWxvZ2luOiR7c3RvcmVOYW1lfWA7XG4gICAgY29uc3QgcmF0ZUxpbWl0ID0gY2hlY2tSYXRlTGltaXQocmF0ZUxpbWl0S2V5LCBSQVRFX0xJTUlUUy5zdG9yZUxvZ2luKTtcblxuICAgIGlmICghcmF0ZUxpbWl0LnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1RvbyBtYW55IGxvZ2luIGF0dGVtcHRzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQyOSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogc3RvcmUsIGVycm9yOiBzdG9yZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXG4gICAgICAuZnJvbSgnc3RvcmVzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBuYW1lJylcbiAgICAgIC5lcSgnbmFtZScsIHN0b3JlTmFtZSlcbiAgICAgIC5tYXliZVNpbmdsZSgpO1xuXG4gICAgaWYgKHN0b3JlRXJyb3IgfHwgIXN0b3JlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIHN0b3JlIG9yIFBJTicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogYXV0aCwgZXJyb3I6IGF1dGhFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxuICAgICAgLmZyb20oJ3N0b3JlX2F1dGgnKVxuICAgICAgLnNlbGVjdCgncGluX2hhc2gnKVxuICAgICAgLmVxKCdzdG9yZV9pZCcsIHN0b3JlLmlkKVxuICAgICAgLm1heWJlU2luZ2xlKCk7XG5cbiAgICBpZiAoYXV0aEVycm9yIHx8ICFhdXRoKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdTdG9yZSBhdXRoZW50aWNhdGlvbiBub3QgY29uZmlndXJlZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IGlzVmFsaWRQaW4gPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwaW4sIGF1dGgucGluX2hhc2gpO1xuXG4gICAgaWYgKCFpc1ZhbGlkUGluKSB7XG4gICAgICBsb2dBdWRpdCh7XG4gICAgICAgIGFjdG9yX3R5cGU6ICdzdG9yZV91c2VyJyxcbiAgICAgICAgYWN0b3JfbGFiZWw6IHN0b3JlTmFtZSxcbiAgICAgICAgYWN0aW9uOiAnc3RvcmVfbG9naW5fZmFpbGVkJyxcbiAgICAgICAgbWV0YWRhdGE6IHsgc3RvcmVfaWQ6IHN0b3JlLmlkLCByZWFzb246ICdpbnZhbGlkX3BpbicgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIHN0b3JlIG9yIFBJTicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlU2Vzc2lvbih7XG4gICAgICB0eXBlOiAnc3RvcmUnLFxuICAgICAgc3RvcmVJZDogc3RvcmUuaWQsXG4gICAgICBzdG9yZU5hbWU6IHN0b3JlLm5hbWUsXG4gICAgfSk7XG5cbiAgICBsb2dBdWRpdCh7XG4gICAgICBhY3Rvcl90eXBlOiAnc3RvcmVfdXNlcicsXG4gICAgICBhY3Rvcl9sYWJlbDogc3RvcmVOYW1lLFxuICAgICAgYWN0aW9uOiAnc3RvcmVfbG9naW5fc3VjY2VzcycsXG4gICAgICBtZXRhZGF0YTogeyBzdG9yZV9pZDogc3RvcmUuaWQgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHN0b3JlOiB7IGlkOiBzdG9yZS5pZCwgbmFtZTogc3RvcmUubmFtZSB9LFxuICAgIH0pO1xuXG4gICAgcmVzcG9uc2UuY29va2llcy5zZXQoQ09PS0lFX05BTUUsIHRva2VuLCB7XG4gICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgIHNhbWVTaXRlOiAnbGF4JyxcbiAgICAgIHBhdGg6ICcvJyxcbiAgICAgIG1heEFnZTogNjAgKiA2MCAqIDI0ICogNyxcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdTdG9yZSBsb2dpbiBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiYmNyeXB0Iiwic3VwYWJhc2VBZG1pbiIsImNyZWF0ZVNlc3Npb24iLCJjaGVja1JhdGVMaW1pdCIsIlJBVEVfTElNSVRTIiwic3RvcmVMb2dpblNjaGVtYSIsImxvZ0F1ZGl0IiwiZHluYW1pYyIsIkNPT0tJRV9OQU1FIiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsInZhbGlkYXRpb24iLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwiZXJyb3IiLCJlcnJvcnMiLCJtZXNzYWdlIiwic3RhdHVzIiwic3RvcmVOYW1lIiwicGluIiwiZGF0YSIsInJhdGVMaW1pdEtleSIsInJhdGVMaW1pdCIsInN0b3JlTG9naW4iLCJzdG9yZSIsInN0b3JlRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJtYXliZVNpbmdsZSIsImF1dGgiLCJhdXRoRXJyb3IiLCJpZCIsImlzVmFsaWRQaW4iLCJjb21wYXJlIiwicGluX2hhc2giLCJhY3Rvcl90eXBlIiwiYWN0b3JfbGFiZWwiLCJhY3Rpb24iLCJtZXRhZGF0YSIsInN0b3JlX2lkIiwicmVhc29uIiwidG9rZW4iLCJ0eXBlIiwic3RvcmVJZCIsIm5hbWUiLCJyZXNwb25zZSIsImNvb2tpZXMiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInNhbWVTaXRlIiwicGF0aCIsIm1heEFnZSIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/store-login/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/audit.ts":
/*!**********************!*\
  !*** ./lib/audit.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logAudit: () => (/* binding */ logAudit)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./lib/supabase/server.ts\");\n\nasync function logAudit(entry) {\n    try {\n        await _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"audit_log\").insert({\n            actor_type: entry.actor_type,\n            actor_label: entry.actor_label,\n            action: entry.action,\n            metadata: entry.metadata || {}\n        });\n    } catch (error) {\n        console.error(\"Failed to log audit event:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXVkaXQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBc0Q7QUFXL0MsZUFBZUMsU0FBU0MsS0FBb0I7SUFDakQsSUFBSTtRQUNGLE1BQU1GLCtEQUFhQSxDQUFDRyxJQUFJLENBQUMsYUFBYUMsTUFBTSxDQUFDO1lBQzNDQyxZQUFZSCxNQUFNRyxVQUFVO1lBQzVCQyxhQUFhSixNQUFNSSxXQUFXO1lBQzlCQyxRQUFRTCxNQUFNSyxNQUFNO1lBQ3BCQyxVQUFVTixNQUFNTSxRQUFRLElBQUksQ0FBQztRQUMvQjtJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsOEJBQThCQTtJQUM5QztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tcGxpYW5jZS1ldmlkZW5jZS1wb3J0YWwvLi9saWIvYXVkaXQudHM/YjNlZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZUFkbWluIH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJztcblxuZXhwb3J0IHR5cGUgQWN0b3JUeXBlID0gJ2FkbWluJyB8ICdzdG9yZV91c2VyJyB8ICdzeXN0ZW0nO1xuXG5leHBvcnQgaW50ZXJmYWNlIEF1ZGl0TG9nRW50cnkge1xuICBhY3Rvcl90eXBlOiBBY3RvclR5cGU7XG4gIGFjdG9yX2xhYmVsOiBzdHJpbmc7XG4gIGFjdGlvbjogc3RyaW5nO1xuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQXVkaXQoZW50cnk6IEF1ZGl0TG9nRW50cnkpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2F1ZGl0X2xvZycpLmluc2VydCh7XG4gICAgICBhY3Rvcl90eXBlOiBlbnRyeS5hY3Rvcl90eXBlLFxuICAgICAgYWN0b3JfbGFiZWw6IGVudHJ5LmFjdG9yX2xhYmVsLFxuICAgICAgYWN0aW9uOiBlbnRyeS5hY3Rpb24sXG4gICAgICBtZXRhZGF0YTogZW50cnkubWV0YWRhdGEgfHwge30sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvZyBhdWRpdCBldmVudDonLCBlcnJvcik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJzdXBhYmFzZUFkbWluIiwibG9nQXVkaXQiLCJlbnRyeSIsImZyb20iLCJpbnNlcnQiLCJhY3Rvcl90eXBlIiwiYWN0b3JfbGFiZWwiLCJhY3Rpb24iLCJtZXRhZGF0YSIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/audit.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth/rate-limit.ts":
/*!********************************!*\
  !*** ./lib/auth/rate-limit.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   RATE_LIMITS: () => (/* binding */ RATE_LIMITS),\n/* harmony export */   checkRateLimit: () => (/* binding */ checkRateLimit)\n/* harmony export */ });\nconst store = new Map();\nconst CLEANUP_INTERVAL = 60000;\nlet lastCleanup = Date.now();\nfunction cleanup() {\n    const now = Date.now();\n    if (now - lastCleanup < CLEANUP_INTERVAL) return;\n    lastCleanup = now;\n    const keysToDelete = [];\n    store.forEach((entry, key)=>{\n        if (entry.resetTime < now) {\n            keysToDelete.push(key);\n        }\n    });\n    keysToDelete.forEach((key)=>store.delete(key));\n}\nfunction checkRateLimit(key, config) {\n    cleanup();\n    const now = Date.now();\n    const entry = store.get(key);\n    if (!entry || entry.resetTime < now) {\n        store.set(key, {\n            count: 1,\n            resetTime: now + config.windowMs\n        });\n        return {\n            success: true,\n            remaining: config.maxAttempts - 1,\n            resetTime: now + config.windowMs\n        };\n    }\n    if (entry.count >= config.maxAttempts) {\n        return {\n            success: false,\n            remaining: 0,\n            resetTime: entry.resetTime\n        };\n    }\n    entry.count++;\n    return {\n        success: true,\n        remaining: config.maxAttempts - entry.count,\n        resetTime: entry.resetTime\n    };\n}\nconst RATE_LIMITS = {\n    storeLogin: {\n        maxAttempts: 5,\n        windowMs: 15 * 60 * 1000\n    },\n    adminLogin: {\n        maxAttempts: 5,\n        windowMs: 15 * 60 * 1000\n    },\n    submission: {\n        maxAttempts: 10,\n        windowMs: 60 * 1000\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC9yYXRlLWxpbWl0LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBS0EsTUFBTUEsUUFBUSxJQUFJQztBQUVsQixNQUFNQyxtQkFBbUI7QUFDekIsSUFBSUMsY0FBY0MsS0FBS0MsR0FBRztBQUUxQixTQUFTQztJQUNQLE1BQU1ELE1BQU1ELEtBQUtDLEdBQUc7SUFDcEIsSUFBSUEsTUFBTUYsY0FBY0Qsa0JBQWtCO0lBRTFDQyxjQUFjRTtJQUNkLE1BQU1FLGVBQXlCLEVBQUU7SUFDakNQLE1BQU1RLE9BQU8sQ0FBQyxDQUFDQyxPQUFPQztRQUNwQixJQUFJRCxNQUFNRSxTQUFTLEdBQUdOLEtBQUs7WUFDekJFLGFBQWFLLElBQUksQ0FBQ0Y7UUFDcEI7SUFDRjtJQUNBSCxhQUFhQyxPQUFPLENBQUMsQ0FBQ0UsTUFBUVYsTUFBTWEsTUFBTSxDQUFDSDtBQUM3QztBQWFPLFNBQVNJLGVBQ2RKLEdBQVcsRUFDWEssTUFBdUI7SUFFdkJUO0lBRUEsTUFBTUQsTUFBTUQsS0FBS0MsR0FBRztJQUNwQixNQUFNSSxRQUFRVCxNQUFNZ0IsR0FBRyxDQUFDTjtJQUV4QixJQUFJLENBQUNELFNBQVNBLE1BQU1FLFNBQVMsR0FBR04sS0FBSztRQUNuQ0wsTUFBTWlCLEdBQUcsQ0FBQ1AsS0FBSztZQUNiUSxPQUFPO1lBQ1BQLFdBQVdOLE1BQU1VLE9BQU9JLFFBQVE7UUFDbEM7UUFDQSxPQUFPO1lBQ0xDLFNBQVM7WUFDVEMsV0FBV04sT0FBT08sV0FBVyxHQUFHO1lBQ2hDWCxXQUFXTixNQUFNVSxPQUFPSSxRQUFRO1FBQ2xDO0lBQ0Y7SUFFQSxJQUFJVixNQUFNUyxLQUFLLElBQUlILE9BQU9PLFdBQVcsRUFBRTtRQUNyQyxPQUFPO1lBQ0xGLFNBQVM7WUFDVEMsV0FBVztZQUNYVixXQUFXRixNQUFNRSxTQUFTO1FBQzVCO0lBQ0Y7SUFFQUYsTUFBTVMsS0FBSztJQUNYLE9BQU87UUFDTEUsU0FBUztRQUNUQyxXQUFXTixPQUFPTyxXQUFXLEdBQUdiLE1BQU1TLEtBQUs7UUFDM0NQLFdBQVdGLE1BQU1FLFNBQVM7SUFDNUI7QUFDRjtBQUVPLE1BQU1ZLGNBQWM7SUFDekJDLFlBQVk7UUFBRUYsYUFBYTtRQUFHSCxVQUFVLEtBQUssS0FBSztJQUFLO0lBQ3ZETSxZQUFZO1FBQUVILGFBQWE7UUFBR0gsVUFBVSxLQUFLLEtBQUs7SUFBSztJQUN2RE8sWUFBWTtRQUFFSixhQUFhO1FBQUlILFVBQVUsS0FBSztJQUFLO0FBQ3JELEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb21wbGlhbmNlLWV2aWRlbmNlLXBvcnRhbC8uL2xpYi9hdXRoL3JhdGUtbGltaXQudHM/YzhkZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgUmF0ZUxpbWl0RW50cnkge1xuICBjb3VudDogbnVtYmVyO1xuICByZXNldFRpbWU6IG51bWJlcjtcbn1cblxuY29uc3Qgc3RvcmUgPSBuZXcgTWFwPHN0cmluZywgUmF0ZUxpbWl0RW50cnk+KCk7XG5cbmNvbnN0IENMRUFOVVBfSU5URVJWQUwgPSA2MDAwMDtcbmxldCBsYXN0Q2xlYW51cCA9IERhdGUubm93KCk7XG5cbmZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGlmIChub3cgLSBsYXN0Q2xlYW51cCA8IENMRUFOVVBfSU5URVJWQUwpIHJldHVybjtcblxuICBsYXN0Q2xlYW51cCA9IG5vdztcbiAgY29uc3Qga2V5c1RvRGVsZXRlOiBzdHJpbmdbXSA9IFtdO1xuICBzdG9yZS5mb3JFYWNoKChlbnRyeSwga2V5KSA9PiB7XG4gICAgaWYgKGVudHJ5LnJlc2V0VGltZSA8IG5vdykge1xuICAgICAga2V5c1RvRGVsZXRlLnB1c2goa2V5KTtcbiAgICB9XG4gIH0pO1xuICBrZXlzVG9EZWxldGUuZm9yRWFjaCgoa2V5KSA9PiBzdG9yZS5kZWxldGUoa2V5KSk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmF0ZUxpbWl0Q29uZmlnIHtcbiAgbWF4QXR0ZW1wdHM6IG51bWJlcjtcbiAgd2luZG93TXM6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSYXRlTGltaXRSZXN1bHQge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICByZW1haW5pbmc6IG51bWJlcjtcbiAgcmVzZXRUaW1lOiBudW1iZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja1JhdGVMaW1pdChcbiAga2V5OiBzdHJpbmcsXG4gIGNvbmZpZzogUmF0ZUxpbWl0Q29uZmlnXG4pOiBSYXRlTGltaXRSZXN1bHQge1xuICBjbGVhbnVwKCk7XG5cbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgZW50cnkgPSBzdG9yZS5nZXQoa2V5KTtcblxuICBpZiAoIWVudHJ5IHx8IGVudHJ5LnJlc2V0VGltZSA8IG5vdykge1xuICAgIHN0b3JlLnNldChrZXksIHtcbiAgICAgIGNvdW50OiAxLFxuICAgICAgcmVzZXRUaW1lOiBub3cgKyBjb25maWcud2luZG93TXMsXG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICByZW1haW5pbmc6IGNvbmZpZy5tYXhBdHRlbXB0cyAtIDEsXG4gICAgICByZXNldFRpbWU6IG5vdyArIGNvbmZpZy53aW5kb3dNcyxcbiAgICB9O1xuICB9XG5cbiAgaWYgKGVudHJ5LmNvdW50ID49IGNvbmZpZy5tYXhBdHRlbXB0cykge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIHJlbWFpbmluZzogMCxcbiAgICAgIHJlc2V0VGltZTogZW50cnkucmVzZXRUaW1lLFxuICAgIH07XG4gIH1cblxuICBlbnRyeS5jb3VudCsrO1xuICByZXR1cm4ge1xuICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgcmVtYWluaW5nOiBjb25maWcubWF4QXR0ZW1wdHMgLSBlbnRyeS5jb3VudCxcbiAgICByZXNldFRpbWU6IGVudHJ5LnJlc2V0VGltZSxcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IFJBVEVfTElNSVRTID0ge1xuICBzdG9yZUxvZ2luOiB7IG1heEF0dGVtcHRzOiA1LCB3aW5kb3dNczogMTUgKiA2MCAqIDEwMDAgfSxcbiAgYWRtaW5Mb2dpbjogeyBtYXhBdHRlbXB0czogNSwgd2luZG93TXM6IDE1ICogNjAgKiAxMDAwIH0sXG4gIHN1Ym1pc3Npb246IHsgbWF4QXR0ZW1wdHM6IDEwLCB3aW5kb3dNczogNjAgKiAxMDAwIH0sXG59O1xuIl0sIm5hbWVzIjpbInN0b3JlIiwiTWFwIiwiQ0xFQU5VUF9JTlRFUlZBTCIsImxhc3RDbGVhbnVwIiwiRGF0ZSIsIm5vdyIsImNsZWFudXAiLCJrZXlzVG9EZWxldGUiLCJmb3JFYWNoIiwiZW50cnkiLCJrZXkiLCJyZXNldFRpbWUiLCJwdXNoIiwiZGVsZXRlIiwiY2hlY2tSYXRlTGltaXQiLCJjb25maWciLCJnZXQiLCJzZXQiLCJjb3VudCIsIndpbmRvd01zIiwic3VjY2VzcyIsInJlbWFpbmluZyIsIm1heEF0dGVtcHRzIiwiUkFURV9MSU1JVFMiLCJzdG9yZUxvZ2luIiwiYWRtaW5Mb2dpbiIsInN1Ym1pc3Npb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth/rate-limit.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth/session.ts":
/*!*****************************!*\
  !*** ./lib/auth/session.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSession: () => (/* binding */ clearSession),\n/* harmony export */   createSession: () => (/* binding */ createSession),\n/* harmony export */   getSession: () => (/* binding */ getSession),\n/* harmony export */   requireAdminSession: () => (/* binding */ requireAdminSession),\n/* harmony export */   requireStoreSession: () => (/* binding */ requireStoreSession),\n/* harmony export */   setSessionCookie: () => (/* binding */ setSessionCookie)\n/* harmony export */ });\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/jwt/sign.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/jwt/verify.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n\n\nconst SECRET = new TextEncoder().encode(process.env.SESSION_SECRET || \"fallback-secret-change-in-production\");\nconst COOKIE_NAME = \"compliance-session\";\nconst EXPIRATION_TIME = \"7d\";\nasync function createSession(payload) {\n    const token = await new jose__WEBPACK_IMPORTED_MODULE_1__.SignJWT({\n        ...payload\n    }).setProtectedHeader({\n        alg: \"HS256\"\n    }).setIssuedAt().setExpirationTime(EXPIRATION_TIME).sign(SECRET);\n    return token;\n}\nasync function setSessionCookie(token) {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    cookieStore.set(COOKIE_NAME, token, {\n        httpOnly: true,\n        secure: \"development\" === \"production\",\n        sameSite: \"lax\",\n        path: \"/\",\n        maxAge: 60 * 60 * 24 * 7\n    });\n}\nasync function getSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const token = cookieStore.get(COOKIE_NAME)?.value;\n    if (!token) {\n        return null;\n    }\n    try {\n        const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_2__.jwtVerify)(token, SECRET);\n        return payload;\n    } catch  {\n        return null;\n    }\n}\nasync function clearSession() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    cookieStore.delete(COOKIE_NAME);\n}\nasync function requireStoreSession() {\n    const session = await getSession();\n    if (!session || session.type !== \"store\") {\n        throw new Error(\"Store authentication required\");\n    }\n    return session;\n}\nasync function requireAdminSession() {\n    const session = await getSession();\n    if (!session || session.type !== \"admin\") {\n        throw new Error(\"Admin authentication required\");\n    }\n    return session;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC9zZXNzaW9uLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUEwQztBQUNIO0FBR3ZDLE1BQU1HLFNBQVMsSUFBSUMsY0FBY0MsTUFBTSxDQUNyQ0MsUUFBUUMsR0FBRyxDQUFDQyxjQUFjLElBQUk7QUFHaEMsTUFBTUMsY0FBYztBQUNwQixNQUFNQyxrQkFBa0I7QUFFakIsZUFBZUMsY0FBY0MsT0FBb0M7SUFDdEUsTUFBTUMsUUFBUSxNQUFNLElBQUliLHlDQUFPQSxDQUFDO1FBQUUsR0FBR1ksT0FBTztJQUFDLEdBQzFDRSxrQkFBa0IsQ0FBQztRQUFFQyxLQUFLO0lBQVEsR0FDbENDLFdBQVcsR0FDWEMsaUJBQWlCLENBQUNQLGlCQUNsQlEsSUFBSSxDQUFDZjtJQUVSLE9BQU9VO0FBQ1Q7QUFFTyxlQUFlTSxpQkFBaUJOLEtBQWE7SUFDbEQsTUFBTU8sY0FBYyxNQUFNbEIscURBQU9BO0lBQ2pDa0IsWUFBWUMsR0FBRyxDQUFDWixhQUFhSSxPQUFPO1FBQ2xDUyxVQUFVO1FBQ1ZDLFFBQVFqQixhQUFvQixLQUFLO1FBQ2pDbUIsVUFBVTtRQUNWQyxNQUFNO1FBQ05DLFFBQVEsS0FBSyxLQUFLLEtBQUs7SUFDekI7QUFDRjtBQUVPLGVBQWVDO0lBQ3BCLE1BQU1SLGNBQWMsTUFBTWxCLHFEQUFPQTtJQUNqQyxNQUFNVyxRQUFRTyxZQUFZUyxHQUFHLENBQUNwQixjQUFjcUI7SUFFNUMsSUFBSSxDQUFDakIsT0FBTztRQUNWLE9BQU87SUFDVDtJQUVBLElBQUk7UUFDRixNQUFNLEVBQUVELE9BQU8sRUFBRSxHQUFHLE1BQU1YLCtDQUFTQSxDQUFDWSxPQUFPVjtRQUMzQyxPQUFPUztJQUNULEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGO0FBRU8sZUFBZW1CO0lBQ3BCLE1BQU1YLGNBQWMsTUFBTWxCLHFEQUFPQTtJQUNqQ2tCLFlBQVlZLE1BQU0sQ0FBQ3ZCO0FBQ3JCO0FBRU8sZUFBZXdCO0lBQ3BCLE1BQU1DLFVBQVUsTUFBTU47SUFDdEIsSUFBSSxDQUFDTSxXQUFXQSxRQUFRQyxJQUFJLEtBQUssU0FBUztRQUN4QyxNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFDQSxPQUFPRjtBQUNUO0FBRU8sZUFBZUc7SUFDcEIsTUFBTUgsVUFBVSxNQUFNTjtJQUN0QixJQUFJLENBQUNNLFdBQVdBLFFBQVFDLElBQUksS0FBSyxTQUFTO1FBQ3hDLE1BQU0sSUFBSUMsTUFBTTtJQUNsQjtJQUNBLE9BQU9GO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jb21wbGlhbmNlLWV2aWRlbmNlLXBvcnRhbC8uL2xpYi9hdXRoL3Nlc3Npb24udHM/ZjY1OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTaWduSldULCBqd3RWZXJpZnkgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IGNvb2tpZXMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuaW1wb3J0IHR5cGUgeyBTZXNzaW9uUGF5bG9hZCB9IGZyb20gJ0AvbGliL3R5cGVzJztcblxuY29uc3QgU0VDUkVUID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKFxuICBwcm9jZXNzLmVudi5TRVNTSU9OX1NFQ1JFVCB8fCAnZmFsbGJhY2stc2VjcmV0LWNoYW5nZS1pbi1wcm9kdWN0aW9uJ1xuKTtcblxuY29uc3QgQ09PS0lFX05BTUUgPSAnY29tcGxpYW5jZS1zZXNzaW9uJztcbmNvbnN0IEVYUElSQVRJT05fVElNRSA9ICc3ZCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTZXNzaW9uKHBheWxvYWQ6IE9taXQ8U2Vzc2lvblBheWxvYWQsICdleHAnPik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHRva2VuID0gYXdhaXQgbmV3IFNpZ25KV1QoeyAuLi5wYXlsb2FkIH0pXG4gICAgLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogJ0hTMjU2JyB9KVxuICAgIC5zZXRJc3N1ZWRBdCgpXG4gICAgLnNldEV4cGlyYXRpb25UaW1lKEVYUElSQVRJT05fVElNRSlcbiAgICAuc2lnbihTRUNSRVQpO1xuXG4gIHJldHVybiB0b2tlbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldFNlc3Npb25Db29raWUodG9rZW46IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBjb29raWVTdG9yZSA9IGF3YWl0IGNvb2tpZXMoKTtcbiAgY29va2llU3RvcmUuc2V0KENPT0tJRV9OQU1FLCB0b2tlbiwge1xuICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICBzYW1lU2l0ZTogJ2xheCcsXG4gICAgcGF0aDogJy8nLFxuICAgIG1heEFnZTogNjAgKiA2MCAqIDI0ICogNyxcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXNzaW9uKCk6IFByb21pc2U8U2Vzc2lvblBheWxvYWQgfCBudWxsPiB7XG4gIGNvbnN0IGNvb2tpZVN0b3JlID0gYXdhaXQgY29va2llcygpO1xuICBjb25zdCB0b2tlbiA9IGNvb2tpZVN0b3JlLmdldChDT09LSUVfTkFNRSk/LnZhbHVlO1xuXG4gIGlmICghdG9rZW4pIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgeyBwYXlsb2FkIH0gPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIFNFQ1JFVCk7XG4gICAgcmV0dXJuIHBheWxvYWQgYXMgdW5rbm93biBhcyBTZXNzaW9uUGF5bG9hZDtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNsZWFyU2Vzc2lvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG4gIGNvb2tpZVN0b3JlLmRlbGV0ZShDT09LSUVfTkFNRSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlU3RvcmVTZXNzaW9uKCk6IFByb21pc2U8U2Vzc2lvblBheWxvYWQ+IHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oKTtcbiAgaWYgKCFzZXNzaW9uIHx8IHNlc3Npb24udHlwZSAhPT0gJ3N0b3JlJykge1xuICAgIHRocm93IG5ldyBFcnJvcignU3RvcmUgYXV0aGVudGljYXRpb24gcmVxdWlyZWQnKTtcbiAgfVxuICByZXR1cm4gc2Vzc2lvbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVpcmVBZG1pblNlc3Npb24oKTogUHJvbWlzZTxTZXNzaW9uUGF5bG9hZD4ge1xuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbigpO1xuICBpZiAoIXNlc3Npb24gfHwgc2Vzc2lvbi50eXBlICE9PSAnYWRtaW4nKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdBZG1pbiBhdXRoZW50aWNhdGlvbiByZXF1aXJlZCcpO1xuICB9XG4gIHJldHVybiBzZXNzaW9uO1xufVxuIl0sIm5hbWVzIjpbIlNpZ25KV1QiLCJqd3RWZXJpZnkiLCJjb29raWVzIiwiU0VDUkVUIiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJwcm9jZXNzIiwiZW52IiwiU0VTU0lPTl9TRUNSRVQiLCJDT09LSUVfTkFNRSIsIkVYUElSQVRJT05fVElNRSIsImNyZWF0ZVNlc3Npb24iLCJwYXlsb2FkIiwidG9rZW4iLCJzZXRQcm90ZWN0ZWRIZWFkZXIiLCJhbGciLCJzZXRJc3N1ZWRBdCIsInNldEV4cGlyYXRpb25UaW1lIiwic2lnbiIsInNldFNlc3Npb25Db29raWUiLCJjb29raWVTdG9yZSIsInNldCIsImh0dHBPbmx5Iiwic2VjdXJlIiwiTk9ERV9FTlYiLCJzYW1lU2l0ZSIsInBhdGgiLCJtYXhBZ2UiLCJnZXRTZXNzaW9uIiwiZ2V0IiwidmFsdWUiLCJjbGVhclNlc3Npb24iLCJkZWxldGUiLCJyZXF1aXJlU3RvcmVTZXNzaW9uIiwic2Vzc2lvbiIsInR5cGUiLCJFcnJvciIsInJlcXVpcmVBZG1pblNlc3Npb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth/session.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabase/server.ts":
/*!********************************!*\
  !*** ./lib/supabase/server.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://pgtkvljxxxuzovlsuzbk.supabase.co\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBndGt2bGp4eHh1em92bHN1emJrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY3ODE3MzEsImV4cCI6MjA4MjM1NzczMX0.tM0qFLFCD4t-BYZvJLCSJ_MQLQkdBqdJPqsgNkWQeXY\";\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXFEO0FBRXJELE1BQU1DLGNBQWNDLDBDQUFvQztBQUN4RCxNQUFNRyxxQkFBcUJILFFBQVFDLEdBQUcsQ0FBQ0cseUJBQXlCLElBQUlKLGtOQUF5QztBQUV0RyxNQUFNTSxnQkFBZ0JSLG1FQUFZQSxDQUFDQyxhQUFhSSxvQkFBb0I7SUFDekVJLE1BQU07UUFDSkMsa0JBQWtCO1FBQ2xCQyxnQkFBZ0I7SUFDbEI7QUFDRixHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY29tcGxpYW5jZS1ldmlkZW5jZS1wb3J0YWwvLi9saWIvc3VwYWJhc2Uvc2VydmVyLnRzPzY2MjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJztcblxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhO1xuY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSB8fCBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSE7XG5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXksIHtcbiAgYXV0aDoge1xuICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxuICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZSxcbiAgfSxcbn0pO1xuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlU2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlQWRtaW4iLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase/server.ts\n");

/***/ }),

/***/ "(rsc)/./lib/validations.ts":
/*!****************************!*\
  !*** ./lib/validations.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminLoginSchema: () => (/* binding */ adminLoginSchema),\n/* harmony export */   craftConfigSchema: () => (/* binding */ craftConfigSchema),\n/* harmony export */   reviewSubmissionSchema: () => (/* binding */ reviewSubmissionSchema),\n/* harmony export */   storeLoginSchema: () => (/* binding */ storeLoginSchema),\n/* harmony export */   storePinSchema: () => (/* binding */ storePinSchema),\n/* harmony export */   submissionSchema: () => (/* binding */ submissionSchema),\n/* harmony export */   updatePeriodKeySchema: () => (/* binding */ updatePeriodKeySchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n\nconst storeLoginSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    storeName: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Store is required\"),\n    pin: zod__WEBPACK_IMPORTED_MODULE_0__.string().length(6, \"PIN must be 6 digits\").regex(/^\\d+$/, \"PIN must contain only numbers\")\n});\nconst adminLoginSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    email: zod__WEBPACK_IMPORTED_MODULE_0__.string().email(\"Invalid email address\"),\n    password: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Password is required\")\n});\nconst submissionSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    control_id: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Control is required\"),\n    submission_date: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Date is required\"),\n    submitter_name: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Your name is required\"),\n    submitter_email: zod__WEBPACK_IMPORTED_MODULE_0__.string().email().optional().or(zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"\")),\n    notes: zod__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nconst reviewSubmissionSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    reviewed_by: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Reviewer is required\")\n});\nconst updatePeriodKeySchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    period_key: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Period key is required\")\n});\nconst storePinSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    store_id: zod__WEBPACK_IMPORTED_MODULE_0__.string().uuid(\"Invalid store ID\"),\n    pin: zod__WEBPACK_IMPORTED_MODULE_0__.string().length(6, \"PIN must be 6 digits\").regex(/^\\d+$/, \"PIN must contain only numbers\")\n});\nconst craftConfigSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    store_id: zod__WEBPACK_IMPORTED_MODULE_0__.string().uuid(\"Invalid store ID\"),\n    period_type: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"weekly\",\n        \"monthly\"\n    ]),\n    craft_doc_id: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1, \"Craft document ID is required\")\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdmFsaWRhdGlvbnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBd0I7QUFFakIsTUFBTUMsbUJBQW1CRCx1Q0FBUSxDQUFDO0lBQ3ZDRyxXQUFXSCx1Q0FBUSxHQUFHSyxHQUFHLENBQUMsR0FBRztJQUM3QkMsS0FBS04sdUNBQVEsR0FBR08sTUFBTSxDQUFDLEdBQUcsd0JBQXdCQyxLQUFLLENBQUMsU0FBUztBQUNuRSxHQUFHO0FBRUksTUFBTUMsbUJBQW1CVCx1Q0FBUSxDQUFDO0lBQ3ZDVSxPQUFPVix1Q0FBUSxHQUFHVSxLQUFLLENBQUM7SUFDeEJDLFVBQVVYLHVDQUFRLEdBQUdLLEdBQUcsQ0FBQyxHQUFHO0FBQzlCLEdBQUc7QUFFSSxNQUFNTyxtQkFBbUJaLHVDQUFRLENBQUM7SUFDdkNhLFlBQVliLHVDQUFRLEdBQUdLLEdBQUcsQ0FBQyxHQUFHO0lBQzlCUyxpQkFBaUJkLHVDQUFRLEdBQUdLLEdBQUcsQ0FBQyxHQUFHO0lBQ25DVSxnQkFBZ0JmLHVDQUFRLEdBQUdLLEdBQUcsQ0FBQyxHQUFHO0lBQ2xDVyxpQkFBaUJoQix1Q0FBUSxHQUFHVSxLQUFLLEdBQUdPLFFBQVEsR0FBR0MsRUFBRSxDQUFDbEIsd0NBQVMsQ0FBQztJQUM1RG9CLE9BQU9wQix1Q0FBUTtBQUNqQixHQUFHO0FBRUksTUFBTXFCLHlCQUF5QnJCLHVDQUFRLENBQUM7SUFDN0NzQixhQUFhdEIsdUNBQVEsR0FBR0ssR0FBRyxDQUFDLEdBQUc7QUFDakMsR0FBRztBQUVJLE1BQU1rQix3QkFBd0J2Qix1Q0FBUSxDQUFDO0lBQzVDd0IsWUFBWXhCLHVDQUFRLEdBQUdLLEdBQUcsQ0FBQyxHQUFHO0FBQ2hDLEdBQUc7QUFFSSxNQUFNb0IsaUJBQWlCekIsdUNBQVEsQ0FBQztJQUNyQzBCLFVBQVUxQix1Q0FBUSxHQUFHMkIsSUFBSSxDQUFDO0lBQzFCckIsS0FBS04sdUNBQVEsR0FBR08sTUFBTSxDQUFDLEdBQUcsd0JBQXdCQyxLQUFLLENBQUMsU0FBUztBQUNuRSxHQUFHO0FBRUksTUFBTW9CLG9CQUFvQjVCLHVDQUFRLENBQUM7SUFDeEMwQixVQUFVMUIsdUNBQVEsR0FBRzJCLElBQUksQ0FBQztJQUMxQkUsYUFBYTdCLHdDQUFNLENBQUM7UUFBQztRQUFVO0tBQVU7SUFDekMrQixjQUFjL0IsdUNBQVEsR0FBR0ssR0FBRyxDQUFDLEdBQUc7QUFDbEMsR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL2NvbXBsaWFuY2UtZXZpZGVuY2UtcG9ydGFsLy4vbGliL3ZhbGlkYXRpb25zLnRzPzAwMGQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbmV4cG9ydCBjb25zdCBzdG9yZUxvZ2luU2NoZW1hID0gei5vYmplY3Qoe1xuICBzdG9yZU5hbWU6IHouc3RyaW5nKCkubWluKDEsICdTdG9yZSBpcyByZXF1aXJlZCcpLFxuICBwaW46IHouc3RyaW5nKCkubGVuZ3RoKDYsICdQSU4gbXVzdCBiZSA2IGRpZ2l0cycpLnJlZ2V4KC9eXFxkKyQvLCAnUElOIG11c3QgY29udGFpbiBvbmx5IG51bWJlcnMnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgYWRtaW5Mb2dpblNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZW1haWw6IHouc3RyaW5nKCkuZW1haWwoJ0ludmFsaWQgZW1haWwgYWRkcmVzcycpLFxuICBwYXNzd29yZDogei5zdHJpbmcoKS5taW4oMSwgJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJyksXG59KTtcblxuZXhwb3J0IGNvbnN0IHN1Ym1pc3Npb25TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGNvbnRyb2xfaWQ6IHouc3RyaW5nKCkubWluKDEsICdDb250cm9sIGlzIHJlcXVpcmVkJyksXG4gIHN1Ym1pc3Npb25fZGF0ZTogei5zdHJpbmcoKS5taW4oMSwgJ0RhdGUgaXMgcmVxdWlyZWQnKSxcbiAgc3VibWl0dGVyX25hbWU6IHouc3RyaW5nKCkubWluKDEsICdZb3VyIG5hbWUgaXMgcmVxdWlyZWQnKSxcbiAgc3VibWl0dGVyX2VtYWlsOiB6LnN0cmluZygpLmVtYWlsKCkub3B0aW9uYWwoKS5vcih6LmxpdGVyYWwoJycpKSxcbiAgbm90ZXM6IHouc3RyaW5nKCksXG59KTtcblxuZXhwb3J0IGNvbnN0IHJldmlld1N1Ym1pc3Npb25TY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHJldmlld2VkX2J5OiB6LnN0cmluZygpLm1pbigxLCAnUmV2aWV3ZXIgaXMgcmVxdWlyZWQnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlUGVyaW9kS2V5U2NoZW1hID0gei5vYmplY3Qoe1xuICBwZXJpb2Rfa2V5OiB6LnN0cmluZygpLm1pbigxLCAnUGVyaW9kIGtleSBpcyByZXF1aXJlZCcpLFxufSk7XG5cbmV4cG9ydCBjb25zdCBzdG9yZVBpblNjaGVtYSA9IHoub2JqZWN0KHtcbiAgc3RvcmVfaWQ6IHouc3RyaW5nKCkudXVpZCgnSW52YWxpZCBzdG9yZSBJRCcpLFxuICBwaW46IHouc3RyaW5nKCkubGVuZ3RoKDYsICdQSU4gbXVzdCBiZSA2IGRpZ2l0cycpLnJlZ2V4KC9eXFxkKyQvLCAnUElOIG11c3QgY29udGFpbiBvbmx5IG51bWJlcnMnKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgY3JhZnRDb25maWdTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHN0b3JlX2lkOiB6LnN0cmluZygpLnV1aWQoJ0ludmFsaWQgc3RvcmUgSUQnKSxcbiAgcGVyaW9kX3R5cGU6IHouZW51bShbJ3dlZWtseScsICdtb250aGx5J10pLFxuICBjcmFmdF9kb2NfaWQ6IHouc3RyaW5nKCkubWluKDEsICdDcmFmdCBkb2N1bWVudCBJRCBpcyByZXF1aXJlZCcpLFxufSk7XG5cbmV4cG9ydCB0eXBlIFN0b3JlTG9naW5JbnB1dCA9IHouaW5mZXI8dHlwZW9mIHN0b3JlTG9naW5TY2hlbWE+O1xuZXhwb3J0IHR5cGUgQWRtaW5Mb2dpbklucHV0ID0gei5pbmZlcjx0eXBlb2YgYWRtaW5Mb2dpblNjaGVtYT47XG5leHBvcnQgdHlwZSBTdWJtaXNzaW9uSW5wdXQgPSB6LmluZmVyPHR5cGVvZiBzdWJtaXNzaW9uU2NoZW1hPjtcbmV4cG9ydCB0eXBlIFJldmlld1N1Ym1pc3Npb25JbnB1dCA9IHouaW5mZXI8dHlwZW9mIHJldmlld1N1Ym1pc3Npb25TY2hlbWE+O1xuZXhwb3J0IHR5cGUgVXBkYXRlUGVyaW9kS2V5SW5wdXQgPSB6LmluZmVyPHR5cGVvZiB1cGRhdGVQZXJpb2RLZXlTY2hlbWE+O1xuZXhwb3J0IHR5cGUgU3RvcmVQaW5JbnB1dCA9IHouaW5mZXI8dHlwZW9mIHN0b3JlUGluU2NoZW1hPjtcbmV4cG9ydCB0eXBlIENyYWZ0Q29uZmlnSW5wdXQgPSB6LmluZmVyPHR5cGVvZiBjcmFmdENvbmZpZ1NjaGVtYT47XG4iXSwibmFtZXMiOlsieiIsInN0b3JlTG9naW5TY2hlbWEiLCJvYmplY3QiLCJzdG9yZU5hbWUiLCJzdHJpbmciLCJtaW4iLCJwaW4iLCJsZW5ndGgiLCJyZWdleCIsImFkbWluTG9naW5TY2hlbWEiLCJlbWFpbCIsInBhc3N3b3JkIiwic3VibWlzc2lvblNjaGVtYSIsImNvbnRyb2xfaWQiLCJzdWJtaXNzaW9uX2RhdGUiLCJzdWJtaXR0ZXJfbmFtZSIsInN1Ym1pdHRlcl9lbWFpbCIsIm9wdGlvbmFsIiwib3IiLCJsaXRlcmFsIiwibm90ZXMiLCJyZXZpZXdTdWJtaXNzaW9uU2NoZW1hIiwicmV2aWV3ZWRfYnkiLCJ1cGRhdGVQZXJpb2RLZXlTY2hlbWEiLCJwZXJpb2Rfa2V5Iiwic3RvcmVQaW5TY2hlbWEiLCJzdG9yZV9pZCIsInV1aWQiLCJjcmFmdENvbmZpZ1NjaGVtYSIsInBlcmlvZF90eXBlIiwiZW51bSIsImNyYWZ0X2RvY19pZCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/validations.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tr46","vendor-chunks/jose","vendor-chunks/whatwg-url","vendor-chunks/webidl-conversions","vendor-chunks/zod","vendor-chunks/bcryptjs"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstore-login%2Froute&page=%2Fapi%2Fauth%2Fstore-login%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstore-login%2Froute.ts&appDir=%2Fhome%2Fproject%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fproject&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();